import{j as e}from"./jsx-runtime.TBa3i5EZ.js";import{r as t}from"./index.CVf8TyFT.js";import{c as R}from"./utils.Dtjc6EhN.js";import{r as L}from"./supabase.CAKu8NRT.js";function M({message:a,type:c,isVisible:l,onClose:d,duration:n=4e3}){if(t.useEffect(()=>{if(l){const g=setTimeout(()=>{d()},n);return()=>clearTimeout(g)}},[l,n,d]),!l)return null;const u=()=>{switch(c){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},m=()=>{switch(c){case"success":return e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"info":return e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}};return e.jsx("div",{className:"w-full animate-fade-in-scale",children:e.jsx("div",{className:`w-full border rounded-lg shadow-lg p-4 ${u()}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:m()}),e.jsx("div",{className:"ml-3 w-0 flex-1",children:e.jsx("p",{className:"text-sm font-medium",children:a})}),e.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:e.jsx("button",{onClick:d,className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none focus:text-gray-600 transition ease-in-out duration-150",children:e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})})}function z({artworkId:a,artworkTitle:c}){const[l,d]=t.useState([]),[n,u]=t.useState({averageRating:0,totalRatings:0}),[m,g]=t.useState(!0),[b,j]=t.useState(!1),[N,f]=t.useState(!1),[x,p]=t.useState({isVisible:!1,message:"",type:"success"}),[r,i]=t.useState({user_name:"",user_email:"",rating:5,comment:""});t.useEffect(()=>{v()},[a]);const v=async()=>{try{g(!0);const[s,o]=await Promise.all([L.getRatingsByArtwork(a),L.getArtworkRatingStats(a)]);d(s),u(o)}catch(s){console.error("Error loading ratings:",s)}finally{g(!1)}},h=async s=>{s.preventDefault(),f(!0);try{const o=new Date,y=new Date(o.getTime()-o.getTimezoneOffset()*6e4).toISOString().slice(0,19);await L.addRating({artwork_id:a,user_name:r.user_name,user_email:r.user_email,rating:r.rating,comment:r.comment,verified:!1,created_at:y}),await v(),i({user_name:"",user_email:"",rating:5,comment:""}),j(!1),p({isVisible:!0,message:"¡Gracias por tu calificación! Tu opinión es muy valiosa para nosotros.",type:"success"})}catch(o){console.error("Error submitting rating:",o),p({isVisible:!0,message:"Error al enviar la calificación. Por favor intenta de nuevo.",type:"error"})}finally{f(!1)}},w=(s,o=!1,y)=>Array.from({length:5},(_,C)=>e.jsx("button",{type:o?"button":void 0,className:`text-2xl ${C<s?"text-yellow-400":"text-gray-300"} ${o?"hover:text-yellow-400 cursor-pointer":""}`,onClick:o&&y?()=>y(C+1):void 0,disabled:!o,children:"★"},C)),S=s=>new Intl.DateTimeFormat("es-ES",{year:"numeric",month:"long",day:"numeric"}).format(new Date(s));return m?e.jsx("div",{className:"bg-white rounded-2xl p-6 art-shadow",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"})]})}):e.jsxs("div",{className:"bg-white rounded-2xl p-6 art-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Calificaciones"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[w(Math.round(n.averageRating)),e.jsx("span",{className:"ml-2 text-lg font-semibold text-gray-700",children:n.averageRating.toFixed(1)})]}),e.jsxs("span",{className:"text-gray-500",children:["(",n.totalRatings," ",n.totalRatings===1?"calificación":"calificaciones",")"]})]})]}),e.jsx("button",{onClick:()=>j(!b),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors",children:b?"Cancelar":"Calificar"})]}),b&&e.jsxs("form",{onSubmit:h,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold mb-4",children:['Califica "',c,'"']}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Tu nombre",value:r.user_name,onChange:s=>i({...r,user_name:s.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),e.jsx("input",{type:"email",placeholder:"Tu email",value:r.user_email,onChange:s=>i({...r,user_email:s.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Calificación"}),e.jsx("div",{className:"flex items-center",children:w(r.rating,!0,s=>i({...r,rating:s}))})]}),e.jsx("div",{className:"mb-4",children:e.jsx("textarea",{placeholder:"Comparte tu opinión sobre esta obra...",value:r.comment,onChange:s=>i({...r,comment:s.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})}),e.jsx("button",{type:"submit",disabled:N,className:"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50",children:N?"Enviando...":"Enviar Calificación"})]}),x.isVisible&&e.jsx("div",{className:"mb-6",children:e.jsx(M,{message:x.message,type:x.type,isVisible:x.isVisible,onClose:()=>p({...x,isVisible:!1})})}),e.jsx("div",{className:"space-y-4",children:l.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Sé el primero en calificar esta obra"}):l.map(s=>e.jsxs("div",{className:"border-b border-gray-200 pb-4 last:border-b-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h5",{className:"font-semibold text-gray-900",children:s.user_name}),s.verified&&e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"✓ Verificado"})]}),e.jsx("div",{className:"flex items-center",children:w(s.rating)})]}),e.jsx("span",{className:"text-sm text-gray-500",children:S(s.created_at)})]}),s.comment&&e.jsxs("p",{className:"text-gray-700 italic",children:['"',s.comment,'"']})]},s.id))})]})}const I=[{id:"1",artworkId:"1",userName:"María González",rating:5,comment:"Una obra absolutamente impresionante. Los colores transmiten una profundidad emocional increíble. Cada vez que la veo descubro nuevos detalles.",date:"2024-01-15",verified:!0},{id:"2",artworkId:"1",userName:"Carlos Ruiz",rating:4,comment:"Me encanta la técnica utilizada. Se nota la maestría de la artista en cada pincelada.",date:"2024-01-10",verified:!1},{id:"3",artworkId:"2",userName:"Ana Martín",rating:5,comment:"La acuarela fluye con una naturalidad asombrosa. Es como ver música convertida en color.",date:"2024-01-20",verified:!0},{id:"4",artworkId:"2",userName:"Pedro López",rating:4,comment:"Hermosa composición. Los tonos cálidos y fríos crean un equilibrio perfecto.",date:"2024-01-12",verified:!1},{id:"5",artworkId:"3",userName:"Laura Fernández",rating:5,comment:"Una reflexión profunda sobre la vida urbana. Me transporta a las calles de la ciudad.",date:"2024-01-18",verified:!0},{id:"6",artworkId:"4",userName:"Miguel Torres",rating:4,comment:"La serenidad que transmite esta obra es increíble. Perfecta para un espacio de meditación.",date:"2024-01-14",verified:!1},{id:"7",artworkId:"5",userName:"Carmen Vega",rating:5,comment:"Pura pasión convertida en arte. Los rojos y naranjas vibran con vida propia.",date:"2024-01-16",verified:!0},{id:"8",artworkId:"6",userName:"Roberto Silva",rating:4,comment:"La textura y los materiales naturales añaden una dimensión única a la obra.",date:"2024-01-13",verified:!1},{id:"9",artworkId:"7",userName:"Sofía Ramírez",rating:5,comment:"¡Mi hija está enamorada de este osito! La calidad del tejido es excepcional y es súper suave.",date:"2024-01-22",verified:!0},{id:"10",artworkId:"7",userName:"Andrea Morales",rating:5,comment:"Perfecto para regalar. El acabado es impecable y se nota el amor con que está hecho.",date:"2024-01-19",verified:!1},{id:"11",artworkId:"8",userName:"Patricia Jiménez",rating:5,comment:"Las orejas largas son adorables y la cola pompón es un detalle encantador. ¡Hermoso trabajo!",date:"2024-01-21",verified:!0},{id:"12",artworkId:"8",userName:"Luis Vargas",rating:4,comment:"Excelente calidad de materiales. Mi sobrina no se separa de él.",date:"2024-01-17",verified:!1},{id:"13",artworkId:"9",userName:"Gabriela Castro",rating:5,comment:"Los detalles bordados son preciosos. La cola curvada le da mucha personalidad.",date:"2024-01-20",verified:!0},{id:"14",artworkId:"9",userName:"Fernando Solís",rating:5,comment:"Compré este gatito para mi esposa y le encantó. La artesanía es de primera calidad.",date:"2024-01-16",verified:!1}];function T({artwork:a,isOpen:c,onClose:l}){const[d,n]=t.useState(0),[u,m]=t.useState(0),[g,b]=t.useState(""),[j,N]=t.useState(""),[f,x]=t.useState([]);t.useEffect(()=>{a&&x(I.filter(r=>r.artworkId===a.id))},[a]),t.useEffect(()=>(typeof document<"u"&&(c?document.body.style.overflow="hidden":document.body.style.overflow="unset"),()=>{typeof document<"u"&&(document.body.style.overflow="unset")}),[c]);const p=(r,i=!1,v="w-5 h-5")=>e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(h=>e.jsx("button",{type:i?"button":void 0,className:R(v,i?"cursor-pointer hover:scale-110 transition-transform":"cursor-default",h<=(i?u||d:r)?"text-yellow-400":"text-gray-300"),onClick:i?()=>n(h):void 0,onMouseEnter:i?()=>m(h):void 0,onMouseLeave:i?()=>m(0):void 0,disabled:!i,children:e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},h))});return!c||!a?null:e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:l}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto art-shadow",children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 z-10 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white transition-colors shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-0",children:[e.jsxs("div",{className:"relative bg-gray-50 flex items-center justify-center",children:[e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-64 lg:h-full max-h-[600px] object-contain p-4 rounded-t-2xl lg:rounded-l-2xl lg:rounded-tr-none"}),!a.available&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-red-500 text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Vendida"})})]}),e.jsxs("div",{className:"p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"font-display text-3xl font-bold text-gray-900 mb-2",children:a.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-4",children:[e.jsx("span",{className:"bg-primary-100 text-primary-700 px-3 py-1 rounded-full font-medium",children:a.category==="oleo"?"Óleo":a.category==="acuarela"?"Acuarela":a.category==="mixta"?"Técnica Mixta":a.category==="amigurumi"?"Amigurumi":"Pintura"}),e.jsx("span",{children:a.year}),e.jsx("span",{children:a.dimensions})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[p(a.rating||0),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",a.totalRatings||f.length," ",f.length===1?"reseña":"reseñas",")"]})]}),a.price&&e.jsxs("div",{className:"text-2xl font-bold text-primary-600 mb-4",children:["₡",a.price.toLocaleString()]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:a.description})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6 text-sm",children:[a.technique&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Técnica:"}),e.jsx("p",{className:"text-gray-600",children:a.technique})]}),a.materials&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Materiales:"}),e.jsx("p",{className:"text-gray-600",children:a.materials.join(", ")})]}),a.inspiration&&e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Inspiración:"}),e.jsx("p",{className:"text-gray-600",children:a.inspiration})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-8",children:[e.jsx("button",{className:"flex-1 bg-primary-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors",children:"Consultar Precio"}),e.jsx("button",{className:"flex-1 border-2 border-primary-600 text-primary-600 font-semibold py-3 px-6 rounded-lg hover:bg-primary-600 hover:text-white transition-colors",children:"Compartir"})]}),e.jsx("div",{className:"border-t pt-6",children:e.jsx(z,{artworkId:a.id,artworkTitle:a.title})})]})]})]})})]})}function P({artwork:a}){const[c,l]=t.useState(!1),d=m=>({pintura:"Pintura",acuarela:"Acuarela",oleo:"Óleo",mixta:"Técnica Mixta",amigurumi:"Amigurumi"})[m]||m,n=()=>{l(!0)},u=()=>{l(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("article",{className:"group relative bg-white rounded-2xl overflow-hidden art-shadow hover:shadow-2xl transition-all duration-500 hover:-translate-y-2 cursor-pointer",onClick:n,children:[e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden",children:[e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsx("span",{className:"text-sm font-medium bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full",children:d(a.category)}),e.jsx("span",{className:"text-sm",children:a.year})]})})}),!a.available&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:"bg-red-500 text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Vendida"})}),a.rating&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-sm px-2 py-1 rounded-full flex items-center space-x-1",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a.rating.toFixed(1)})]})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-display text-xl font-semibold text-gray-900 mb-2 group-hover:text-primary-600 transition-colors duration-300",children:a.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsx("span",{children:a.dimensions}),a.price&&e.jsxs("span",{className:"font-semibold text-primary-600",children:["₡",a.price.toLocaleString()]})]})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black/20",children:e.jsx("button",{className:"bg-white text-primary-600 px-6 py-2 rounded-full font-semibold hover:bg-primary-600 hover:text-white transition-colors duration-300",children:"Ver Detalles"})})]}),e.jsx(T,{artwork:a,isOpen:c,onClose:u})]})}export{P as default};
