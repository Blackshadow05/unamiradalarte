import{j as e}from"./jsx-runtime.TBa3i5EZ.js";import{r as n}from"./index.CVf8TyFT.js";import{r as A}from"./supabase.CAKu8NRT.js";function E(){const[r,x]=n.useState([]),[i,d]=n.useState([]),[f,p]=n.useState(!0),[m,y]=n.useState(0),[M,g]=n.useState(!1),[j,u]=n.useState(null),[v,h]=n.useState(null),[b,w]=n.useState(0),N={1:"Susurros del Alma",2:"Danza de Colores",3:"Reflexiones Urbanas",4:"Serenidad Azul",5:"Fuego Interior",6:"Naturaleza Abstracta",7:"Osito Dulce",8:"Conejito Primaveral",9:"Gatito Mimoso"};n.useEffect(()=>{R()},[]),n.useEffect(()=>{if(r.length>0){I();const t=setInterval(()=>{y(s=>(s+1)%6)},8e3);return()=>clearInterval(t)}},[r]),n.useEffect(()=>{if(r.length>6){g(!0);const t=Math.floor(Math.random()*i.length);u(t);const s=setTimeout(()=>{S(t),u(null),h(t),w(a=>a+1),setTimeout(()=>{g(!1),h(null)},2e3)},3e3);return()=>clearTimeout(s)}},[m,r.length,i.length]);const R=async()=>{try{const s=(await A.getAllRatings()).filter(a=>a.comment&&a.comment.trim().length>0).map(a=>({...a,artwork_title:N[a.artwork_id]||`Obra ${a.artwork_id}`}));x(s)}catch(t){console.error("Error loading ratings:",t)}finally{p(!1)}},I=()=>{if(r.length===0)return;const s=[...r].sort(()=>Math.random()-.5).slice(0,Math.min(6,r.length));d(s)},S=t=>{if(r.length<=6)return;const s=r.filter(o=>!i.some(l=>l.id===o.id));if(s.length===0)return;const a=Math.floor(Math.random()*s.length),c=s[a];d(o=>{const l=[...o];return l[t]=c,l})},k=t=>Array.from({length:5},(s,a)=>e.jsx("span",{className:`text-yellow-400 ${a<t?"opacity-100":"opacity-30"}`,children:"★"},a)),$=t=>new Intl.DateTimeFormat("es-ES",{year:"numeric",month:"long",day:"numeric"}).format(new Date(t));return f?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((t,s)=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 art-shadow animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded mb-4"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})]})]},s))}):i.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No hay calificaciones disponibles"})}):e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((t,s)=>{const a=s===m%i.length,c=j===s,o=v===s;return e.jsxs("div",{className:`bg-white rounded-2xl p-6 art-shadow transition-all duration-[3000ms] ease-in-out transform hover:scale-[1.01] hover:shadow-lg ${a?"ring-1 ring-primary-100 shadow-lg bg-gradient-to-br from-white via-white to-primary-25":""} ${c?"opacity-0 scale-[0.95]":"opacity-100 scale-100"} ${o?"animate-slide-in-from-top-cascade":""}`,style:{transitionProperty:"opacity, transform, box-shadow",transitionTimingFunction:"cubic-bezier(0.23, 1, 0.32, 1)",transitionDuration:"3000ms"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center text-sm",children:k(t.rating)}),t.verified&&e.jsx("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full font-medium",children:"✓ Verificado"})]}),e.jsxs("blockquote",{className:"text-gray-700 text-sm leading-relaxed mb-4 italic line-clamp-3",children:['"',t.comment,'"']}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.user_name}),e.jsx("p",{className:"text-primary-600 font-medium",children:t.artwork_title})]}),e.jsx("p",{children:$(t.created_at)})]})]},o?`${t.id}-${b}-${s}`:`${t.id}-${s}`)})}),e.jsx("div",{className:"text-center mt-12",children:e.jsxs("a",{href:"/calificaciones",className:"inline-flex items-center px-8 py-4 bg-primary-600 text-white font-semibold rounded-2xl hover:bg-primary-700 transition-all duration-300 transform hover:scale-105 hover:shadow-xl art-shadow",children:[e.jsx("span",{children:"Ver Más Calificaciones"}),e.jsx("svg",{className:"ml-2 w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})}export{E as default};
